# ---------------------------------------------------------------------
# function to calculate production at each trophic level
# flow[thau+0.1] = flow[thau] * exp(-µ×Δτ) = te_htl^0.1 (Gascuel et al., 2005, 2011 (https://doi.org/10.1016/j.icesjms.2004.12.013 & https://doi.org/10.1093/icesjms/fsr062) &  du Pontavice et al., Subm)
# flow[thau+0.1] = te_htl^0.1 is a geometric sequence (where common ratio=te_htl^0.1)
# flow[thau] = flow3*(te_htl^0.1)^(length(seq_tl) - 1)
geomseq_n_prod <- function(flow3,te_htl,len_seq) {
  seq<-seq(0,len_seq-1)
  flow_tl_3to7<-flow3*(te_htl^0.1)**(seq)
  # mean biomass flow
  flow_m_tl_3to7<-flow_tl_3to7*(1-(te_htl^0.1))/(0.1*(-log(te_htl)))
  # production
  prod_tl_3to7<-flow_m_tl_3to7*0.1
  return(prod_tl_3to7) # ratio^seq get a vector}
}
# 
# Example
# flow3<-1000
# te_htl<-0.08
# len_seq<-length(seq(3,7,.1))

