# ---------------------------------------------------------------------
# function to calculate production between 2 and 3
# ---------------------------------------------------------------------
# Production between TL=2 and TL=3 
# with the transition :
# from TE LTL at TL=2
# to TE HTL at TL=3 (TE LTL in du Pontavice et al., Subm)
# ---------------------------------------------------------------------
# te_ltl: low trophic levels transfer efficiency
# flow2: flow at tl=2
# flow_m2: mean flow between TL and TL+delta_TL
# sequence of TL between 2 and 7 with a range 0.1 TL
# ---------------------------------------------------------------------
prod_tl_2to3_fixed_te_htl<-function(te_ref,flow2,flow_m2,te_ltl,seq_tl) {
  # intitialization at TL=2 with production at TL=2
  flow_tl<-flow2
  # store the mean biomass flow
  prod_2<-flow_m2*0.1
  # production
  prod_2to3<-prod_2
  for (i in seq_tl) { # loop to calculate prod between TL=2.1 and 3
    flow_tl<-flow_tl*(te_tl_2to3(i,te_ltl,te_ref)^0.1)
    # mean biomass flow between TL and TL+delta_TL
    flow_m_tl<-flow_tl*(1-te_ltl^0.1)/(0.1*(-log(te_ltl)))
    # production between TL and TL+delta_TL
    prod_tl<-flow_m_tl*0.1
    # store the value
    prod_2to3 <- c(prod_2to3,prod_tl)
  }
  return(prod_2to3)  
}