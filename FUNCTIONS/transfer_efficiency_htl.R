# ---------------------------------------------------------------------
# function to calculate Transfer Efficiency up to 3 based on du Pontavice et al., 2019
# ---------------------------------------------------------------------
# TE is varying according to SST and ecosystem type
te_htl_funct <- function(eco_type,sst) {
  if (eco_type == "polar"){b=0; a=0;}
  if (eco_type == "temperate"){b=(0.142); a=(-0.013)}
  if (eco_type == "tropical"){b=(-0.352); a=(0.015)}
  if (eco_type == "upwelling"){b=(0.167); a=(-0.032)}
  return(exp((-2.162) + (-0.025)*sst + b + a*sst)*1.038013)
}